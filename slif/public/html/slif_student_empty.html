<div class="slif_block">
<p>Для работы данного модуля укажите адрес страницы для отображения во фрейме.</p><p>Памятка работы модуля &laquo;<em>ShowLessonInIframeXBlock</em>&raquo;, коротко: <em>slif</em>.</p><p>1) Для общения родительского окна (edx) со встроенныем (&laquo;урок&raquo;) необходимо инициализировать библиотеку <a href="https://github.com/mozilla/jschannel/blob/master/src/jschannel.js">jschannel.js</a></p><p><br />2) В &laquo;уроке&raquo; должны быть реализованы следующие функции:</p><ul><li><code>var getGrade = function() &#123;&#125;;</code><p>Эта функция вызывается, когда edx захочет получить отметку учащегося.<br />Функция возвращает число &mdash; сколько баллов получил учащийся.<br /><code>var some_mark = 5.0;<br />return JSON.stringify(some_mark); </code></p></li><li><code>var getState = function() &#123;&#125;;</code><p>Эта функция вызывается, когда edx хочет записать текущее состояние урока (для его восстановления в случае необходимости)</p><p>Функция возвращает строку для сохранения в БД.<br />Например можно все запихнуть в словарь, а потом передать этот словарь в виде строки<br /><code>return JSON.stringify(some_dict);</code></p></li><li><code>var setState = function (a, params) &#123;&#125;;</code><p>Функция вызывается edx в начале загрузки скрипта. И может быть использована для восстановления значений форм, комментариев и т.д.</p><p>Вторым аргументом функции передается словарь с ключами <em>state</em> и <em>score</em><br />Пока предлагается получать значения так:<br /><code>if (params.state)&#123;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; state = JSON.parse(params.state);</code></p><p><em>state</em> &mdash; то, что сохранили в getState<br /><em>answer</em> &mdash; то, что сохранили в getGrade</p></li><li>Когда вы захотите, чтобы edx забрал отметку (вызвал <em>getGrade</em>), необходимо вызвать метод <em><strong>i_am_ready</strong></em> и выставить answer = 1<br /><code>channel.notify(&#123;method: &quot;i_am_ready&quot;, params: &#123;&#39;answer&#39;: 1, &#39;state&#39;: 0&#125;&#125;);</code><p>Когда вы захотите, чтобы edx сохранил состояние урока (вызвал <em>getState</em>):<br /><code>channel.notify(&#123;method: &quot;i_am_ready&quot;, params: &#123;&#39;answer&#39;: 0, &#39;state&#39;: 1&#125;&#125;);</code></p><p>Когда вы захотите, чтобы edx сохранил состояние урока и забрал баллы (ученик например нажал кнопку заверщить тест или проверить):<br /><code>channel.notify(&#123;method: &quot;i_am_ready&quot;, params: &#123;&#39;answer&#39;: 1, &#39;state&#39;: 1&#125;&#125;);</code></p></li></ul>
</div>
